ggplot(aes(x=y,
group=nationalism, color=nationalism, fill=nationalism,
alpha=0.5)) +
theme_minimal() +
geom_density() +
geom_vline(xintercept = 2.309,
linetype="longdash", alpha=0.5, color='red', size=1.25) +
geom_vline(xintercept = 2.660,
linetype="longdash", alpha=0.5, color='#00BFC4', size=1.25) +
annotate("text", x = 1.25, y = 0.5,
label = "no nationalism", color='red', alpha=0.5) +
annotate("text", x = 4.5, y = 0.45,
label = "nationalism", color='#00BFC4', alpha=0.5) +
labs(x="log(number of agreements + 1)") +
theme(legend.position = "none")
text_gamma2 %>%
mutate(y = log(agree+1),
nationalism = as.character(nationalismD2)) %>%
ggplot(aes(x=y,
group=nationalism, color=nationalism, fill=nationalism,
alpha=0.5)) +
theme_minimal() +
geom_density() +
geom_vline(xintercept = 2.309,
linetype="longdash", alpha=0.5, color='red', size=1.25) +
geom_vline(xintercept = 2.660,
linetype="longdash", alpha=0.5, color='#00BFC4', size=1.25) +
annotate("text", x = 1, y = 0.5,
label = "no nationalism", color='red', alpha=0.5) +
annotate("text", x = 4, y = 0.45,
label = "nationalism", color='#00BFC4', alpha=0.85) +
labs(x="log(number of agreements + 1)") +
theme(legend.position = "none")
text_gamma2 %>%
mutate(y = log(agree+1),
nationalism = as.character(nationalismD2)) %>%
ggplot(aes(x=y,
group=nationalism, color=nationalism, fill=nationalism,
alpha=0.5)) +
theme_minimal() +
geom_density() +
geom_vline(xintercept = 2.309,
linetype="longdash", alpha=0.5, color='red', size=1.25) +
geom_vline(xintercept = 2.660,
linetype="longdash", alpha=0.5, color='#00BFC4', size=1.25) +
annotate("text", x = 1, y = 0.5,
label = "no nationalism", color='red', alpha=0.5) +
annotate("text", x = 3.9, y = 0.45,
label = "nationalism", color='#00BFC4', alpha=0.85) +
labs(x="log(number of agreements + 1)") +
theme(legend.position = "none")
text_gamma2 %>%
mutate(y = log(agree+1),
nationalism = as.character(nationalismD2)) %>%
ggplot(aes(x=y,
group=nationalism, color=nationalism, fill=nationalism,
alpha=0.5)) +
theme_minimal() +
geom_density() +
geom_vline(xintercept = 2.309,
linetype="longdash", alpha=0.5, color='red', size=1.25) +
geom_vline(xintercept = 2.660,
linetype="longdash", alpha=0.5, color='#00BFC4', size=1.25) +
annotate("text", x = 1, y = 0.5,
label = "no nationalism", color='red', alpha=0.5) +
annotate("text", x = 3.9, y = 0.45,
label = "nationalism", color='#00BFC4', alpha=0.85) +
labs(x="log(number of agreements + 1)", y="density") +
theme(legend.position = "none")
rm(df, df2, wdi, wdi2, wdi3)
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
devtools::install_github("EmilHvitfeldt/xaringancolor")
library(xaringancolor)
xaringan::inf_mr()
xaringan::inf_mr()
rm(list=ls())
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
# to use FontAwesome
#htmltools::tagList(rmarkdown::html_dependency_font_awesome())
library(fontawesome)
library(ggplot2)
library(dplyr)
knitr::opts_chunk$set(warning = FALSE, message = FALSE, error=F, echo=F)
options(htmltools.preserve.raw = FALSE) # for fontawesome
library(WDI)
library(tidyverse)
library(WDI)
update.packages('WDI')
xaringan::inf_mr()
xaringan::inf_mr()
library(ggplot2)
library(dplyr)
wdi2 %>%
mutate(lnFDI = log(abs(FDI + 1))) %>%
mutate(lnFDI = ifelse(FDI<0, FDI*(-1), lnFDI)) %>%
ggplot(aes(year, lnFDI, color=developed)) +
geom_point(alpha=0.1,size=2) +
geom_smooth(alpha=0.25, size=3) +
labs(x="Year",
y="Gross FDI net inflow") +
theme(legend.title = element_blank()) +
scale_color_manual(values=c("red", "blue")) +
theme(legend.text = element_text(size=13),
axis.text=element_text(size=15),
axis.title=element_text(size=15))
wdi2 %>%
mutate(lnFDI = log(abs(FDI + 1))) %>%
mutate(lnFDI = ifelse(FDI<0, lnFDI*(-1), lnFDI)) %>%
ggplot(aes(year, lnFDI, color=developed)) +
geom_point(alpha=0.1,size=2) +
geom_smooth(alpha=0.25, size=3) +
labs(x="Year",
y="Gross FDI net inflow") +
theme(legend.title = element_blank()) +
scale_color_manual(values=c("red", "blue")) +
theme(legend.text = element_text(size=13),
axis.text=element_text(size=15),
axis.title=element_text(size=15))
wdi2 %>%
mutate(lnFDI = log2(abs(FDI + 1))) %>%
mutate(lnFDI = ifelse(FDI<0, lnFDI*(-1), lnFDI)) %>%
ggplot(aes(year, lnFDI, color=developed)) +
geom_point(alpha=0.1,size=2) +
geom_smooth(alpha=0.25, size=3) +
labs(x="Year",
y="Gross FDI net inflow") +
theme(legend.title = element_blank()) +
scale_color_manual(values=c("red", "blue")) +
theme(legend.text = element_text(size=13),
axis.text=element_text(size=15),
axis.title=element_text(size=15))
wdi2 %>%
mutate(lnFDI = log10(abs(FDI + 1))) %>%
mutate(lnFDI = ifelse(FDI<0, lnFDI*(-1), lnFDI)) %>%
ggplot(aes(year, lnFDI, color=developed)) +
geom_point(alpha=0.1,size=2) +
geom_smooth(alpha=0.25, size=3) +
labs(x="Year",
y="Gross FDI net inflow") +
theme(legend.title = element_blank()) +
scale_color_manual(values=c("red", "blue")) +
theme(legend.text = element_text(size=13),
axis.text=element_text(size=15),
axis.title=element_text(size=15))
wdi2 %>%
mutate(lnFDI = log10(abs(FDI + 1))) %>%
filter(FDI !=0) %>%
mutate(lnFDI = ifelse(FDI<0, lnFDI*(-1), lnFDI)) %>%
ggplot(aes(year, lnFDI, color=developed)) +
geom_point(alpha=0.1,size=2) +
geom_smooth(alpha=0.25, size=3) +
labs(x="Year",
y="Gross FDI net inflow") +
theme(legend.title = element_blank()) +
scale_color_manual(values=c("red", "blue")) +
theme(legend.text = element_text(size=13),
axis.text=element_text(size=15),
axis.title=element_text(size=15))
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
rm(list=ls())
xaringan
xaringan::inf_mr()
rm(list=ls())
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
kbl(text, booktabs = T) %>%
column_spec(1, bold = T, color = 'red', width = '10em')
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::\
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
library(ggrepel)
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
library(dplyr)
library(dplyr)
library(WDI)
library(ggplot2)
var = c('Trade.gdp' = 'NE.TRD.GNFS.ZS',
'imports' = 'NE.IMP.GNFS.CD',
'exports' = 'NE.EXP.GNFS.CD',
'GDPpc' = 'NY.GDP.PCAP.KD',
'tariff' = 'TM.TAX.MRCH.SM.AR.ZS',
'totalMexport' = 'TX.VAL.MRCH.CD.WT', # merchandise exports
'totalSexport' = 'BX.GSR.NFSV.CD') # service exports
wdi <- WDI(indicator=var,
start=1960,
country = 'all',
end=2022,
extra=TRUE)
wdi %>%
drop_na(GDPpc) %>%
mutate(developed =
case_when(GDPpc > 20000 ~ "developed",
GDPpc < 20000 ~ "underdeveloped"
)) -> wdi2
tabulate(wdi$country)
table(wdi$country)
wdi %>%
group_by(year) %>%
mutate(worldM = ifelse(country ==
'World',
totalMexport,
totalMexport[country == 'World'])) %>%
mutate(worldS = ifelse(country ==
'World',
totalSexport,
totalSexport[country == 'World'])) %>%
ungroup() -> wdi3
View(wdi3)
wdi %>%
group_by(year) %>%
mutate(worldM = ifelse(country ==
'World',
totalMexport,
totalMexport[country == 'World'])) %>%
mutate(worldS = ifelse(country ==
'World',
totalSexport,
totalSexport[country == 'World'])) %>%
ungroup() %>%
drop_na(GDPpc) -> wdi3
wdi %>%
group_by(year) %>%
mutate(worldM = ifelse(country ==
'World',
totalMexport,
totalMexport[country == 'World'])) %>%
mutate(worldS = ifelse(country ==
'World',
totalSexport,
totalSexport[country == 'World'])) %>%
ungroup() %>%
mutate(shareM = totalMexport/worldM,
shareS = totalSexport/worldS) %>%
drop_na(GDPpc) -> wdi3
wdi %>%
group_by(year) %>%
mutate(worldM = ifelse(country ==
'World',
totalMexport,
totalMexport[country == 'World'])) %>%
mutate(worldS = ifelse(country ==
'World',
totalSexport,
totalSexport[country == 'World'])) %>%
ungroup() %>%
mutate(shareM = totalMexport/worldM,
shareS = totalSexport/worldS) %>%
drop_na(GDPpc) %>%
filter(year==2019) -> wdi3
data1 <- wdi3 %>%
arrange(desc(shareM)) %>%
select(country, shareM)
data2 <- wdi3 %>%
arrange(desc(shareS))
top_n <- 10
top_cat <- data1[1:top_n, ]
rest <- data.frame(Name = "The Rest", shareM = sum(data1[(top_n + 1):nrow(data1), ]$shareM))
rest1 <- data.frame(Name = "The Rest 1", shareM = sum(data1[(top_n + 1):nrow(data1), ]$shareM))
rest2 <- data.frame(Name = "The Rest 2", shareS = sum(data2[(top_n + 1):nrow(data2), ]$shareS))
comM <- rbind(top_cat, rest1)
top_n <- 10
top_cat1 <- data1[1:top_n, ]
top_cat2 <- data2[1:top_n, ]
top_n <- 10
top_cat1 <- data1[1:top_n, ]
top_cat2 <- data2[1:top_n, ]
rest1 <- data.frame(country = "The Rest", shareM = sum(data1[(top_n + 1):nrow(data1), ]$shareM))
rest2 <- data.frame(country = "The Rest", shareS = sum(data2[(top_n + 1):nrow(data2), ]$shareS))
comM <- rbind(top_cat1, rest1)
comS <- rbind(top_cat2, rest2)
View(rest2)
View(rest1)
rm(top_cat)
View(top_cat1)
View(wdi3)
wdi %>%
group_by(year) %>%
mutate(worldM = ifelse(country ==
'World',
totalMexport,
totalMexport[country == 'World'])) %>%
mutate(worldS = ifelse(country ==
'World',
totalSexport,
totalSexport[country == 'World'])) %>%
ungroup() %>%
mutate(shareM = totalMexport/worldM,
shareS = totalSexport/worldS) %>%
drop_na(GDPpc) %>%
filter(year==2019) %>%
filter(region != "Aggregates") -> wdi3
data1 <- wdi3 %>%
arrange(desc(shareM)) %>%
select(country, shareM)
View(data1)
data2 <- wdi3 %>%
arrange(desc(shareS)) %>%
select(country, shareS)
top_n <- 10
top_cat1 <- data1[1:top_n, ]
top_cat2 <- data2[1:top_n, ]
View(top_cat2)
rest1 <- data.frame(country = "The Rest", shareM = sum(data1[(top_n + 1):nrow(data1), ]$shareM))
rest2 <- data.frame(country = "The Rest", shareS = sum(data2[(top_n + 1):nrow(data2), ]$shareS))
comM <- rbind(top_cat1, rest1)
comS <- rbind(top_cat2, rest2)
View(comS)
total_share1 <- sum(comM$shareM)
total_share1 <- sum(top_cat1$shareM)
rest_share1 <- 1 - sum(top_cat1$shareM)
rest_share1 <- 1 - sum(top_cat1$shareM)
rest_share2 <- 1 - sum(top_cat2$shareS)
rest1 <- data.frame(country = "The Rest", shareM = rest_share1)
rest2 <- data.frame(country = "The Rest", shareS = rest_share2)
comM <- rbind(top_cat1, rest1)
comS <- rbind(top_cat2, rest2)
View(comM)
pie1 <- comM %>%
ggplot(aes(x="", y=shareM, fill=country)) +
geom_bar(stat = 'identity', width = 1) +
coord_polar(theta = "y") +
theme_void()
pie1
View(comM)
View(comS)
colors <- c(rep("black", 1), scales::hue_pal()(top_n))
pie1 <- comM %>%
ggplot(aes(x="", y=shareM, fill=country)) +
geom_bar(stat = 'identity', width = 1) +
coord_polar(theta = "y") +
theme_void() +
scale_fill_manual(values = colors)
pie1
colors <- c(rep("black", 1), scales::hue_pal()(bottom_n))
comM <- rbind(top_cat1, rest1)
comS <- rbind(top_cat2, rest2)
comM <- rbind(rest1, top_cat1)
comM <- rbind(rest1, top_cat1)
comS <- rbind(rest2, top_cat2)
colors <- c(rep("black", 1), scales::hue_pal()(top_n))
pie1 <- comM %>%
ggplot(aes(x="", y=shareM, fill=country)) +
geom_bar(stat = 'identity', width = 1) +
coord_polar(theta = "y") +
theme_void() +
scale_fill_manual(values = colors)
pie1
View(comM)
pie1 <- comM %>%
ggplot(aes(x="", y=shareM, fill=country)) +
geom_bar(stat = 'identity', width = 1) +
coord_polar(theta = "y") +
theme_void() +
scale_fill_manual(values = colors)
pie1
comM <- rbind(rest1, top_cat1)
View(comM)
colors <- c(scales::hue_pal()(top_n), "black")
pie1 <- comM %>%
ggplot(aes(x="", y=shareM, fill=country)) +
geom_bar(stat = 'identity', width = 1) +
coord_polar(theta = "y") +
theme_void() +
scale_fill_manual(values = colors)
pie1
View(comM)
colors <- c(rep("black", 1), scales::hue_pal()(top_n))
comM %>%
ggplot(aes(x="", y=shareM, fill=country)) +
geom_bar(stat = 'identity', width = 1) +
coord_polar(theta = "y") +
theme_void() +
scale_fill_manual(values = colors)
comM <- rbind(top_cat1, rest1)
colors <- c(scales::hue_pal()(top_n), "black")
comM %>%
ggplot(aes(x="", y=shareM, fill=country)) +
geom_bar(stat = 'identity', width = 1) +
coord_polar(theta = "y") +
theme_void() +
scale_fill_manual(values = colors)
top_cat_colors <- scales::hue_pal()(top_n)
comM %>%
ggplot(aes(x="", y=shareM, fill=country)) +
geom_bar(stat = 'identity', width = 1) +
coord_polar(theta = "y") +
theme_void() +
scale_fill_manual(values = c(top_cat_colors, "black"),
breaks = c(top_cat$country, "The Rest"))
comM %>%
ggplot(aes(x="", y=shareM, fill=country)) +
geom_bar(stat = 'identity', width = 1) +
coord_polar(theta = "y") +
theme_void() +
scale_fill_manual(values = c(top_cat_colors, "black"),
breaks = c(top_cat1$country, "The Rest"))
pie2 <- comS %>%
ggplot(aes(x="", y=shareS, fill=country)) +
geom_bar(stat = 'identity', width = 1) +
coord_polar(theta = "y") +
theme_void() +
scale_fill_manual(values = c(top_cat_colors, "black"),
breaks = c(top_cat2$country, "The Rest"))
pie2
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
