---
title: "GLOA101"
author: "Byunghwan Son <br> George Mason University"
date: " "
#########################################
linkcolor: red
citecolor: blue
urlcolor: blue√ü
output: 
  xaringan::moon_reader:
    seal: false
    nature:
      beforeInit: "https://platform.twitter.com/widgets.js"
      ratio: '16:9'
      highlightStyle: github
  #    self-contained: TRUE
  chakra: css/libs/remark-latest.min.js
css: ["default", 
      "css/footer.css", 
      "css/color.css", 
      # "css/xaringan-themer.css",
      default-fonts]
lib_dir: css/libs
beforeInit: "css/macros.js"
# seal: false  
#bibliography: /Users/bson3/Dropbox/latex/mybib2.bib
#remotes::install_github('yihui/xaringan', upgrade = TRUE)
---

```{r setup, include=FALSE}
# to use FontAwesome
#htmltools::tagList(rmarkdown::html_dependency_font_awesome())
library(dplyr)
library(tidyr)
library(fs)
library(fontawesome)
# library(magick)  
library(ggplot2)
library(WDI)
knitr::opts_chunk$set(warning = FALSE, message = FALSE, error=F, echo=F)
options(htmltools.preserve.raw = FALSE)
library(xaringancolor)
setup_colors(
  red = "red",
  green = "green",
  blue = "blue",
  yellow = "yellow"
)

```

class: inverse, center, middle
background-image: url(https://ichef.bbci.co.uk/images/ic/1376xn/p01l97cj.jpg.webp)
background-size: 100%

# .Huge[**Global Conflicts, Crimes & Terrorism**]
## .yellow[GLOA101]

---


## Trends of (.Blue[intra]- and .pink[inter]-state) War <br> .tiny[data source: Correlates of War Project]
--

$$ \color{green}{war\ per\ country}_t = \frac{\color{red}{total}\ number\ of\ wars_t}{\color{red}{total}\ number\ of\ countries_t} $$
--

```{r echo=FALSE, message=FALSE, warning=FALSE, cache=TRUE}

# devtools::install_github("prio-data/priogrid")
# https://rforpoliticalscience.com/category/ucdp-prio/
# install.packages('peacesciencer')
# install.packages('states')

library(vdemdata)
library(reshape2)

df0 <- vdem %>%
  select(year, 
         COWcode,
         e_civil_war, 
         e_miinteco,
         e_regionpol_6C,
         v2cltort,
         v2clkill,
         e_pematmor) %>%
  rename(civil.war = e_civil_war,
         war = e_miinteco,
         region = e_regionpol_6C,
         mom.mortality = e_pematmor,
         no.torture = v2cltort,
         no.kill = v2clkill)


# 6=Asia

df0 %>%
  group_by(year) %>%
  add_count() -> df

df %>%
  filter(!is.na(civil.war)) %>%
  group_by(year) %>%
  mutate(mean.civilwar = sum(civil.war)/n) -> df

df %>%
  filter(!is.na(war)) %>%
  group_by(year) %>%
  mutate(mean.war = sum(war)/n) -> df


var = c('life' = 'SP.DYN.LE00.IN'
        )

wdi <- WDI(indicator=var,
           start=1960,
           country = 'all',
           end=2020,
           extra=TRUE)


#### GTD data
library(readxl)
gtd <- read_excel('/Users/bson3/Library/CloudStorage/OneDrive-GeorgeMasonUniversity-O365Production/data_repo/GlobalTerrorismDataset/globalterrorismdb_0522dist.xlsx')

gtd %>%
  select(iyear, INT_ANY) -> gtd



```

```{r, echo=FALSE, fig.height=7, fig.width=18, message=FALSE, warning=FALSE, cache=TRUE}
df %>%
  ggplot(aes(x=year, alpha=0.5)) +
  geom_line(aes(y=mean.war, color='a'), size=1.5, ) +
  geom_line(aes(y=mean.civilwar, color='b'), size=1.5, ) +
  labs(x = "Year",
       y = "war per country") + 
  theme_minimal() +
  theme(axis.text=element_text(size=20),
        axis.title=element_text(size=25),
        legend.title=element_text(size=20),
        legend.text=element_text(size=20)) +
        scale_color_manual(name = "War Types",
                           labels = c("Interstate War","Civil War"), 
                           values = c('a'='red', 'b'= 'blue')) +
  scale_alpha(guide = 'none')

```

---

## (.pink[Transnational]) .Blue[Terrorist Attacks] .tiny[(data source: GTD)]
--

.large[**.black[Terrorist attack]**: "the threatened or actual use of illegal force and violence by a non-state actor to attain a political, economic, religious, or social goal through fear, coercion, or intimidation" (state terrorism excluded)]

--

```{r, echo=FALSE, fig.height=7, fig.width=18, message=FALSE, warning=FALSE, cache=TRUE}

gtd %>%
  filter(INT_ANY != -9) %>%
  ggplot(aes(x=iyear, fill=factor(INT_ANY))) +
  geom_bar(stat = "count", alpha=0.5) +
  theme_minimal() +
  labs(x='year') +
  theme(axis.text=element_text(size=20),
        axis.title=element_text(size=25),
        legend.title=element_text(size=0),
        legend.text=element_text(size=20),
        legend.position = c(0.2, 0.9)) +
  scale_fill_manual(values = c("blue", "red"),
                    labels = c("domestic", "international")
                    ) 
  

```


---
# **Human Security**: Freedom from .red[Political Killing] and .blue[Torture] <br> .tiny[(data source: Vdem)]


```{r, echo=FALSE, fig.height=7.5, fig.width=15, message=FALSE, warning=FALSE, cache=TRUE}

df0 %>%
  ggplot(aes(x = year)) + 
  geom_point(aes(y = no.kill, color = "no.kill"), alpha = 0.1, size = 0.1) +
  geom_point(aes(y = no.torture, color = "no.torture"), alpha = 0.1, size = 0.1) +  
  geom_smooth(aes(y = no.kill, color = "no.kill"), alpha = 0.5) + 
  geom_smooth(aes(y = no.torture, color = "no.torture"), alpha = 0.5) +
  scale_color_manual(values = c("no.kill" = "red", 
                                "no.torture" = "blue"),
                     labels = c("no.kill" = "Freedom from political killing   ", 
                                "no.torture" = "Freedom from torture")) +
  theme_minimal() +
  labs(y="") +
  theme(
    axis.text = element_text(size = 20),
    axis.title = element_text(size = 25),
    legend.title = element_text(size = 0),
    legend.text = element_text(size = 20),
     legend.position = "bottom"
  )

```

---


# **Human Security**: Life expectancy at birth <br> .tiny[data source: World Development Indicators]

```{r, echo=FALSE, fig.height=6.5, fig.width=14, message=FALSE, warning=FALSE, cache=TRUE}

wdi %>%
  ggplot(aes(x = year, y=life, alpha=0.1, fill='red', color='red')) +
  geom_point(size=1) + 
  geom_smooth() +
  theme_minimal() + 
  theme(
    axis.text = element_text(size = 20),
    axis.title = element_text(size = 25),
    legend.position = "none") +
  labs(y="Life Expectancy")


```

